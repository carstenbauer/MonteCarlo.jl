<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DQMC · MonteCarlo.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MonteCarlo.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">MonteCarlo.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/gettingstarted/">Getting started</a></li><li><a class="tocitem" href="../../manual/showcase/">Showcase</a></li></ul></li><li><span class="tocitem">Physical models</span><ul><li><a class="tocitem" href="../../models/ising/">Ising model</a></li><li><a class="tocitem" href="../../models/hubbardattractive/">Attractive Hubbard model</a></li></ul></li><li><span class="tocitem">Monte Carlo flavors</span><ul><li><a class="tocitem" href="../mc/">MC</a></li><li class="is-active"><a class="tocitem" href>DQMC</a><ul class="internal"><li><a class="tocitem" href="#Technical-details-1"><span>Technical details</span></a></li><li><a class="tocitem" href="#Exports-1"><span>Exports</span></a></li><li><a class="tocitem" href="#Potential-extensions-1"><span>Potential extensions</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../lattices/">Lattices</a></li><li><a class="tocitem" href="../../customize/">Customize</a></li><li><span class="tocitem">Interfaces</span><ul><li><a class="tocitem" href="../../interfaces/MC/">MC</a></li><li><a class="tocitem" href="../../interfaces/DQMC/">DQMC</a></li></ul></li><li><span class="tocitem">General exports</span><ul><li><a class="tocitem" href="../../methods/general/">General</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Monte Carlo flavors</a></li><li class="is-active"><a href>DQMC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DQMC</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/crstnbr/MonteCarlo.jl/blob/master/docs/src/flavors/dqmc.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Determinant-Quantum-Monte-Carlo-(DQMC)-1"><a class="docs-heading-anchor" href="#Determinant-Quantum-Monte-Carlo-(DQMC)-1">Determinant Quantum Monte Carlo (DQMC)</a><a class="docs-heading-anchor-permalink" href="#Determinant-Quantum-Monte-Carlo-(DQMC)-1" title="Permalink"></a></h1><p>This is determinant quantum Monte Carlo (MC) also known auxiliary field quantum Monte Carlo. It can be used to simulate interacting fermion systems, here the auxiliary boson arises from a Hubbard Stratonovich transformation, or fermions which are naturally coupled to bosons. An example is the <a href="../../models/hubbardattractive/#Attractive-Hubbard-Model-1">Attractive Hubbard Model</a>.</p><p>You can initialize a determinant quantum Monte Carlo simulation of a given <code>model</code> simply through</p><pre><code class="language-julia">dqmc = DQMC(model, beta=5.0)</code></pre><p>Mandatory keywords are:</p><ul><li><code>beta</code>: inverse temperature</li></ul><p>Allowed keywords are:</p><ul><li><code>delta_tau::Float64 = 0.1</code>: imaginary time step size</li><li><code>safe_mult::Int = 10</code>: stabilize Green&#39;s function calculations every <code>safe_mult</code> step (How many slice matrices can be multiplied until singular value information is lost due to numerical unaccuracy?)</li><li><code>checkerboard::Float64 = false</code>: use <a href="#Checkerboard-decomposition-1">Checkerboard decomposition</a> (faster)</li><li><code>sweeps</code>: number of measurement sweeps</li><li><code>thermalization</code>: number of thermalization (warmup) sweeps</li><li><code>seed</code>: initialize DQMC with custom seed</li><li><code>all_checks::Bool = true</code>: turn off to suppress some numerical checks</li></ul><p>Afterwards, you can run the simulation by</p><pre><code class="language-julia">run!(dqmc)</code></pre><h2 id="Technical-details-1"><a class="docs-heading-anchor" href="#Technical-details-1">Technical details</a><a class="docs-heading-anchor-permalink" href="#Technical-details-1" title="Permalink"></a></h2><h3 id="Symmetric-Suzuki-Trotter-decomposition-1"><a class="docs-heading-anchor" href="#Symmetric-Suzuki-Trotter-decomposition-1">Symmetric Suzuki-Trotter decomposition</a><a class="docs-heading-anchor-permalink" href="#Symmetric-Suzuki-Trotter-decomposition-1" title="Permalink"></a></h3><p>We use the symmetric version of the Suzuki-Trotter decomposition, i.e.</p><p>\begin{align} e^{-\Delta\tau \sum<em>l T+V(l)} = \prod</em>j e^{-\Delta\tau T/2} e^{-\Delta\tau V} e^{-\Delta\tau T/2} + \mathcal{O}(\Delta\tau^2) \end{align}</p><p>where <span>$T$</span> is the hopping matrix and <span>$V(l)$</span> is the interaction matrix with <span>$l$</span> an imaginary time slice index indicating an auxiliary field dependence.</p><p>With the imaginary time slice matrices <span>$B_l = e^{-\Delta\tau T/2} e^{-\Delta\tau V(l)} e^{-\Delta\tau T/2}$</span> the equal-time Green&#39;s function is <span>$G = \left( 1 + B_M \cdots B_1 \right)^{-1}$</span>.</p><h3 id="Checkerboard-decomposition-1"><a class="docs-heading-anchor" href="#Checkerboard-decomposition-1">Checkerboard decomposition</a><a class="docs-heading-anchor-permalink" href="#Checkerboard-decomposition-1" title="Permalink"></a></h3><p>We provide a general algorithm to construct the &quot;checkerboard&quot; split up of a generic <code>AbstractLattice</code>. The only requirement is that the <code>AbstractLattice</code> has the following two fields,</p><ul><li><code>n_bonds::Int</code>: total number of bonds (lattice graph edges)</li><li><code>bonds::Matrix{Int}</code>: bond matrix of shape <code>(n_bonds, 3)</code>. Rows correspond to bonds and columns indicate source site, target site, and bond type in this order.</li></ul><p>Of course, one can also manually construct a (more efficient) checkerboard split up by overloading the following function for the specific <code>AbstractLattice</code> subtype.</p><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.build_checkerboard-Tuple{MonteCarlo.AbstractLattice}" href="#MonteCarlo.build_checkerboard-Tuple{MonteCarlo.AbstractLattice}"><code>MonteCarlo.build_checkerboard</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">build_checkerboard(l::Lattice) -&gt; checkerboard, groups, n_groups</code></pre><p>Generic checkerboard construction.</p><p>The methods returns     * <code>checkerboard::Matrix{Int}</code>: size <code>(3, n_bonds)</code> where                 rows = <code>source site</code>, <code>target site</code>, <code>bondid</code> and cols                     correspond to bonds. Sorted (along columns) in such a way                     that <code>checkerboard[3, groups[i]]</code> are all the bond indices                     corresponding to the i-th group.     * <code>groups::Vector{UnitRange}</code>: ranges indicating which columns of <code>checkerboard</code>                     belong to which checkerboard group.     * <code>n_groups::Int</code>: number of checkerboard groups.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/abstract.jl#L8-L22">source</a></section></article><h3 id="Effective-slice-matrices-and-Green&#39;s-function-1"><a class="docs-heading-anchor" href="#Effective-slice-matrices-and-Green&#39;s-function-1">Effective slice matrices and Green&#39;s function</a><a class="docs-heading-anchor-permalink" href="#Effective-slice-matrices-and-Green&#39;s-function-1" title="Permalink"></a></h3><p>Combining the symmetric Suzuki-Trotter and checkerboard decomposition we can write (assuming two checkerboard groups <span>$a$</span> and <span>$b$</span>)</p><p>\begin{align} e^{-\Delta\tau \sum<em>l T+V(l)} &amp;= e^{\Delta\tau T</em>a/2} e^{\Delta\tau T<em>b/2} \\
&amp;\times \left( \prod</em>j e^{-\Delta\tau T<em>b/2} e^{-\Delta\tau T</em>a} e^{-\Delta\tau T<em>b/2} e^{-\Delta\tau V} \right) e^{-\Delta\tau T</em>b/2} e^{-\Delta\tau T_a/2} + \mathcal{O}(\Delta\tau^2) \end{align}</p><p>For performance resons we internally work with effective imaginary time slice matrices</p><div>\[B_l^{\text{eff}} = e^{-\Delta\tau T_b/2} e^{-\Delta\tau T_a} e^{-\Delta\tau T_b/2} e^{-\Delta\tau V}\]</div><p>instead of the original <span>$B_l$</span>s above.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Note that one consequence is that the field <code>dqmc.s.greens</code> isn&#39;t the actual Green&#39;s function but an effective one defined by \begin{align} G &amp;= \left( 1 + B<em>M \cdots B</em>1 \right)^{-1} \\
&amp;= e^{\Delta\tau T<em>a/2} e^{\Delta\tau T</em>b/2} \left( 1 + B^{\text{eff}}<em>M \cdots B^{\text{eff}}</em>1 \right)^{-1} e^{-\Delta\tau T<em>b/2} e^{-\Delta\tau T</em>a/2} \\
&amp;= e^{\Delta\tau T<em>a/2} e^{\Delta\tau T</em>b/2} G^{\text{eff}} e^{-\Delta\tau T<em>b/2} e^{-\Delta\tau T</em>a/2} \end{align}</p><p>To obtain the actual equal-times Green&#39;s function, for example for measuring, use <code>greens(dqmc::DQMC)</code>. Note that although <span>$G\overset{!}{=}G^\text{eff}$</span>} one can readily show that <span>$\det G = \det G^{\text{eff}}$</span> holds and the Metropolis acceptance is not affected by switching to the effective matrices.</p></div></div><h2 id="Exports-1"><a class="docs-heading-anchor" href="#Exports-1">Exports</a><a class="docs-heading-anchor-permalink" href="#Exports-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.greens-Tuple{DQMC{M,MonteCarlo.CheckerboardFalse,ConfType,Stack} where Stack&lt;:MonteCarlo.AbstractDQMCStack where ConfType where M}" href="#MonteCarlo.greens-Tuple{DQMC{M,MonteCarlo.CheckerboardFalse,ConfType,Stack} where Stack&lt;:MonteCarlo.AbstractDQMCStack where ConfType where M}"><code>MonteCarlo.greens</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">greens(mc::DQMC)</code></pre><p>Obtain the current equal-time Green&#39;s function.</p><p>Internally, <code>mc.s.greens</code> is an effective Green&#39;s function. This method transforms this effective one to the actual Green&#39;s function by multiplying hopping matrix exponentials from left and right.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/DQMC.jl#L581-L589">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.replay!-Tuple{DQMC}" href="#MonteCarlo.replay!-Tuple{DQMC}"><code>MonteCarlo.replay!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replay(
    mc::DQMC[;
    configs::ConfigurationMeasurement = mc.measurements[:conf],
    reset_measurements = true,
    measure_rate = 1,
    kwargs...]
)
replay(mc::DQMC, configs::AbstractArray[; kwargs...])</code></pre><p>Replays previously generated configurations and measures observables along the way.</p><p>By default, the first method will search <code>mc</code> for a ConfigurationMeasurement, remove it from the active measurements and replay it. If <code>reset_measurements = true</code> it will also reset every active measurement before replaying configurations. The second method replays configurations directly, i.e. it does not modify any measurements beforehand.</p><p><strong>Keyword Arguments (both):</strong></p><ul><li><code>verbose = true</code>: If true, print progress messaged to stdout.</li><li><code>safe_before::Date</code>: If this date is passed, <code>replay!</code> will generate a</li></ul><p>resumable save file and exit</p><ul><li><code>grace_period = Minute(5)</code>: Buffer between the current time and <code>safe_before</code>.</li></ul><p>The time required to generate a save file should be included here.</p><ul><li><code>filename</code>: Name of the save file. The default is based on <code>safe_before</code>.</li><li><code>start=1</code>: The first sweep in the simulation. This will be changed when using</li></ul><p><code>resume!(save_file)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/DQMC.jl#L455-L484">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.run!-Tuple{DQMC}" href="#MonteCarlo.run!-Tuple{DQMC}"><code>MonteCarlo.run!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">run!(mc::DQMC[; kwargs...])</code></pre><p>Runs the given Monte Carlo simulation <code>mc</code>. Returns true if the run finished and false if it cancelled early to generate a resumable save-file.</p><p><strong>Keyword Arguments:</strong></p><ul><li><code>verbose = true</code>: If true, print progress messaged to stdout.</li><li><code>thermalization</code>: Number of thermalization sweeps. Uses the value passed to</li></ul><p><code>DQMC</code> by default.</p><ul><li><code>sweeps</code>: Number of measurement sweeps. Uses the value passed to <code>DQMC</code> by</li></ul><p>default.</p><ul><li><code>safe_before::Date</code>: If this date is passed, <code>run!</code> will generate a resumable</li></ul><p>save file and exit</p><ul><li><code>grace_period = Minute(5)</code>: Buffer between the current time and <code>safe_before</code>.</li></ul><p>The time required to generate a save file should be included here.</p><ul><li><code>resumable_filename</code>: Name of the resumable save file. The default is based on</li></ul><p><code>safe_before</code>.</p><ul><li><code>force_overwrite = false</code>: If set to true a file with the same name as</li></ul><p><code>resumable_filename</code> will be overwritten. (This will create a temporary backup)</p><p>See also: <a href="flavors/@ref"><code>resume!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/DQMC.jl#L236-L258">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.DQMC" href="#MonteCarlo.DQMC"><code>MonteCarlo.DQMC</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Determinant quantum Monte Carlo (DQMC) simulation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/DQMC.jl#L71-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.DQMC-Union{Tuple{M}, Tuple{M}} where M&lt;:MonteCarlo.Model" href="#MonteCarlo.DQMC-Union{Tuple{M}, Tuple{M}} where M&lt;:MonteCarlo.Model"><code>MonteCarlo.DQMC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">DQMC(m::M; kwargs...) where M&lt;:Model</code></pre><p>Create a determinant quantum Monte Carlo simulation for model <code>m</code> with keyword parameters <code>kwargs</code>.</p><p><strong>Keyword Arguments:</strong></p><ul><li><code>seed</code>: The random seed used by the simulation.</li><li><code>checkerboard=false</code>: If true, the simulation uses a generic checkerboard</li></ul><p>decomposition.</p><ul><li><code>thermalization_measurements::Dict{Symbol, AbstractMeasurement}</code>: A collection</li></ul><p>of measurements run during the thermalization stage. By default, none are used.</p><ul><li><code>measurements::Dict{Symbol, AbstractMeasurement}</code>: A collection of measurements</li></ul><p>run during the measurement stage. Calls <code>default_measurements</code> if not specified.</p><ul><li><code>thermalization = 100</code>: Number of thermalization sweeps</li><li><code>sweeps</code>: Number of measurement sweeps</li><li><code>all_checks = true</code>: Check for Propagation instabilities and sign problems.</li><li><code>safe_mult = 10</code>: Number of &quot;safe&quot; matrix multiplications. Every <code>safe_mult</code></li></ul><p>multiplications, a UDT decomposition is used to stabilize the product.</p><ul><li><code>delta_tau = 0.1</code>: Time discretization of the path integral</li><li><code>beta::Float64</code>: Inverse temperature used in the simulation</li><li><code>slices::Int = beta / delta_tau</code>: Number of imaginary time slice in the</li></ul><p>simulation</p><ul><li><code>measure_rate = 10</code>: Number of sweeps discarded between every measurement.</li><li><code>global_moves = false</code>:: Currently not used</li><li><code>global_rate = 5</code>: Currently not used</li><li><code>last_sweep = 0</code>: Sets the index of the last finished sweep. The simulation</li></ul><p>will start with sweep <code>last_sweep + 1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/DQMC.jl#L93-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonteCarlo.DQMC-Union{Tuple{T}, Tuple{MonteCarlo.Model,Dict{Symbol,T}}} where T" href="#MonteCarlo.DQMC-Union{Tuple{T}, Tuple{MonteCarlo.Model,Dict{Symbol,T}}} where T"><code>MonteCarlo.DQMC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">DQMC(m::M, params::Dict)
DQMC(m::M, params::NamedTuple)</code></pre><p>Create a determinant quantum Monte Carlo simulation for model <code>m</code> with (keyword) parameters as specified in the dictionary/named tuple <code>params</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/crstnbr/MonteCarlo.jl/blob/f38c2ff9da49ad1ec207703643c2187884cee35b/src/flavors/DQMC/DQMC.jl#L153-L159">source</a></section></article><h2 id="Potential-extensions-1"><a class="docs-heading-anchor" href="#Potential-extensions-1">Potential extensions</a><a class="docs-heading-anchor-permalink" href="#Potential-extensions-1" title="Permalink"></a></h2><p>Pull requests are very much welcome!</p><ul><li>todo</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mc/">« MC</a><a class="docs-footer-nextpage" href="../../lattices/">Lattices »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 9 August 2020 01:45">Sunday 9 August 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
