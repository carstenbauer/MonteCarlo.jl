<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Update Scheduler · MonteCarlo.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MonteCarlo.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">MonteCarlo.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">DQMC</span><ul><li><a class="tocitem" href="../Introduction/">Introduction</a></li><li><a class="tocitem" href="../model/">Model</a></li><li><a class="tocitem" href="../lattice/">Lattices</a></li><li><a class="tocitem" href="../fields/">Fields</a></li><li><a class="tocitem" href="../dqmc/">DQMC</a></li><li><a class="tocitem" href="../recorder/">Configuration Recorder</a></li><li class="is-active"><a class="tocitem" href>Update Scheduler</a><ul class="internal"><li><a class="tocitem" href="#Schedulers-1"><span>Schedulers</span></a></li><li><a class="tocitem" href="#Updates-1"><span>Updates</span></a></li></ul></li><li><a class="tocitem" href="../measurements/">Measurements</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/triangular_Hubbard/">Triangular Attractive Hubbard</a></li><li><a class="tocitem" href="../../examples/ALF1/">Crosscheck with ALF</a></li><li><a class="tocitem" href="../../examples/HofmannBergChowdhury/">Topological Flat Band Model</a></li></ul></li><li><span class="tocitem">Legacy</span><ul><li><a class="tocitem" href="../../legacy/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/manual/gettingstarted/">Getting started</a></li><li><a class="tocitem" href="../../legacy/manual/showcase/">Showcase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Physical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/models/ising/">Ising model</a></li><li><a class="tocitem" href="../../legacy/models/hubbardattractive/">Attractive Hubbard model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Monte Carlo flavors</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/flavors/mc/">MC</a></li><li><a class="tocitem" href="../../legacy/flavors/dqmc/">DQMC</a></li></ul></li><li><a class="tocitem" href="../../legacy/lattices/">Lattices</a></li><li><a class="tocitem" href="../../legacy/customize/">Customize</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/interfaces/MC/">MC</a></li><li><a class="tocitem" href="../../legacy/interfaces/DQMC/">DQMC</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">General exports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/methods/general/">General</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">DQMC</a></li><li class="is-active"><a href>Update Scheduler</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Update Scheduler</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/carstenbauer/MonteCarlo.jl/blob/master/docs/src/DQMC/scheduler.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Update-Scheduler-1"><a class="docs-heading-anchor" href="#Update-Scheduler-1">Update Scheduler</a><a class="docs-heading-anchor-permalink" href="#Update-Scheduler-1" title="Permalink"></a></h1><p>The update scheduler keeps track of and iterates through various Monte Carlo updates. Currently there are two schedulers, <code>SimpleScheduler</code> and <code>AdaptiveScheduler</code>, and five (full) updates.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This is a DQMC only feature at the moment.</p></div></div><h2 id="Schedulers-1"><a class="docs-heading-anchor" href="#Schedulers-1">Schedulers</a><a class="docs-heading-anchor-permalink" href="#Schedulers-1" title="Permalink"></a></h2><h4 id="SimpleScheduler-1"><a class="docs-heading-anchor" href="#SimpleScheduler-1">SimpleScheduler</a><a class="docs-heading-anchor-permalink" href="#SimpleScheduler-1" title="Permalink"></a></h4><p>The <code>SimpleScheduler</code> keeps track of a sequence of updates and cycles through them as <code>update(scheduler, mc, model)</code> is called. It is constructed by simply passing a sequence of updates, i.e. <code>SimpleScheduler(update1, update2, ...)</code>.</p><h4 id="AdaptiveScheduler-1"><a class="docs-heading-anchor" href="#AdaptiveScheduler-1">AdaptiveScheduler</a><a class="docs-heading-anchor-permalink" href="#AdaptiveScheduler-1" title="Permalink"></a></h4><p>The <code>AdaptiveScheduler</code> also has a static sequence of updates, but allows some of these updates to be <code>Adaptive()</code>. Any <code>Adaptive()</code> update in the sequence is replaced with an update from a pool based on their relative weights. These weights are derived from their acceptance rates with some lag.</p><p>An adaptive scheduler is created with a sequence of updates and a pool of updates, i.e.</p><pre><code class="language-julia">sequence = (update1, Adaptive())
pool = (update2, update3)
scheduler = AdaptiveScheduler(sequence, pool)</code></pre><p>Additionally there are a couple of keywords to configure how weights are adjusted.</p><ul><li><code>minimum_sampling_rate = 0.01</code>: This defines the threshold under which the </li></ul><p>sampling rate is set to 0.</p><ul><li><code>grace_period = 99</code>: This sets a minimum number of times an update needs to </li></ul><p>be called before its sampling rate is adjusted. </p><ul><li><code>adaptive_rate = 9.0</code>: Controls how fast the sampling rate is adjusted to the </li></ul><p>acceptance rate. More means slower.</p><p>The adjustments of the sampling rate follow the formula \begin{equation} \frac{(adaptive<em>rate * sampling</em>rate + \frac{accepted}{total} }{ adaptive_rate + 1 } \end{equation}</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All schedulers wrap their updates in <code>AcceptanceStatistics</code>. This wrapper keeps track of the total number of update attempts and the number of accepted updates.</p></div></div><h2 id="Updates-1"><a class="docs-heading-anchor" href="#Updates-1">Updates</a><a class="docs-heading-anchor-permalink" href="#Updates-1" title="Permalink"></a></h2><p>Updates are small or even empty structs used to dispatch to different <code>update</code> functions. They are assumed to implement <code>name(::MyUpdate) = &quot;MyUpdate&quot;</code> and a method <code>update(::MyUpdate, mc, model)</code>. </p><h3 id="Local-Updates-1"><a class="docs-heading-anchor" href="#Local-Updates-1">Local Updates</a><a class="docs-heading-anchor-permalink" href="#Local-Updates-1" title="Permalink"></a></h3><p>Local updates affect one site at one time slice. In order for this to be on a similar scale as global and parallel updates, local updates should come in full sweeps. </p><h4 id="LocalSweep-1"><a class="docs-heading-anchor" href="#LocalSweep-1">LocalSweep</a><a class="docs-heading-anchor-permalink" href="#LocalSweep-1" title="Permalink"></a></h4><p>Currently there is only one local update - <code>LocalSweep([N=1])</code>. It performs N standard sweeps of local updates, which means two updates per site and time slice each in DQMC. (Two because we go from <span>$\tau = 0$</span> to <span>$\tau = \beta$</span> back to <span>$\tau = 0$</span>.) This update returns a float corresponding to its internal acceptance rate <span>$accepted / (2 N_{sites} M_{slices}$</span></p><h3 id="Global-Updates-1"><a class="docs-heading-anchor" href="#Global-Updates-1">Global Updates</a><a class="docs-heading-anchor-permalink" href="#Global-Updates-1" title="Permalink"></a></h3><p>Global updates affect not just one site at one time slice, but most if not all sites at all time slices. In other words they attempt to adjust the full configuration. We currently have the following global updates.</p><h4 id="GlobalFlip-1"><a class="docs-heading-anchor" href="#GlobalFlip-1">GlobalFlip</a><a class="docs-heading-anchor-permalink" href="#GlobalFlip-1" title="Permalink"></a></h4><p>The <code>GlobalFlip()</code> proposes a flip of the full configuration, i.e. <span>$\pm 1 \to \mp 1$</span>.</p><h4 id="GlobalShuffle-1"><a class="docs-heading-anchor" href="#GlobalShuffle-1">GlobalShuffle</a><a class="docs-heading-anchor-permalink" href="#GlobalShuffle-1" title="Permalink"></a></h4><p><code>GlobalShuffle()</code> performs a <code>shuffle(current_configuration)</code> to generate a new configuration.</p><h4 id="SpatialShuffle-1"><a class="docs-heading-anchor" href="#SpatialShuffle-1">SpatialShuffle</a><a class="docs-heading-anchor-permalink" href="#SpatialShuffle-1" title="Permalink"></a></h4><p><code>SpatialShuffle</code> shuffles only the spatial part of a configuration. This means that if two sites are swapped, they are swapped the same way for all time slice indices.</p><h4 id="TemporalShuffle-1"><a class="docs-heading-anchor" href="#TemporalShuffle-1">TemporalShuffle</a><a class="docs-heading-anchor-permalink" href="#TemporalShuffle-1" title="Permalink"></a></h4><p><code>TemporalShuffle</code> shuffles only the imaginary time part of the configuration, meaning that the swap occurs for all lattice indices the same way.</p><h4 id="Denoise-1"><a class="docs-heading-anchor" href="#Denoise-1">Denoise</a><a class="docs-heading-anchor-permalink" href="#Denoise-1" title="Permalink"></a></h4><p><code>Denoise</code> attempts to align the configuration in lattice space. Specifically, it sets each site to the majority value of its neighbors (including itself with a lower weight). Note that this update assumes configuration values <span>$\pm 1$</span>. Also note that the new configuration is solely based on the old, i.e. it does not take changes of nearby sites into account. Because of this the update may not always push the configuration to a more uniform distribution.</p><h4 id="DenoiseFlip-1"><a class="docs-heading-anchor" href="#DenoiseFlip-1">DenoiseFlip</a><a class="docs-heading-anchor-permalink" href="#DenoiseFlip-1" title="Permalink"></a></h4><p><code>DenoiseFlip</code> follows the logic of <code>Denoise</code>, but flips the resulting configuration.</p><h4 id="StaggeredDenoise-1"><a class="docs-heading-anchor" href="#StaggeredDenoise-1">StaggeredDenoise</a><a class="docs-heading-anchor-permalink" href="#StaggeredDenoise-1" title="Permalink"></a></h4><p><code>StaggeredDenoise</code> follows the same logic as <code>Denoise</code>, but multiplies a factor <span>$\pm 1$</span> based on the lattice site index. </p><h3 id="Parallel-Updates-1"><a class="docs-heading-anchor" href="#Parallel-Updates-1">Parallel Updates</a><a class="docs-heading-anchor-permalink" href="#Parallel-Updates-1" title="Permalink"></a></h3><p>Parallel updates communicate between different simulations running on different workers. Note that these simulations must produce configurations of the same size, i.e. have same number of time slices and sites.</p><h4 id="ReplicaExchange-1"><a class="docs-heading-anchor" href="#ReplicaExchange-1">ReplicaExchange</a><a class="docs-heading-anchor-permalink" href="#ReplicaExchange-1" title="Permalink"></a></h4><p>The <code>ReplicaExchange(target)</code> update requires a target worker, and it requires that worker to be in sync. Specifically that means if worker 1 has a <code>ReplicaExchange(2)</code> followed by <code>ReplicaExchange(3)</code>, worker 2 must have <code>ReplicaExchange(1)</code> as its first replica exchange update and worker 3 must have <code>ReplicaExchange(1)</code> as its second replica exchange update.</p><p>The idea of a replica exchange update is to propose swapping configurations between two simulations. The exchange is based on the product of both of their acceptance probabilities. With <span>$C_i$</span> the configuration of simulation <span>$i$</span> and <span>$w_i(C)$</span> the weight of simulation <span>$i$</span> with the given configuration the acceptance probability is given by</p><div>\[p = \frac{w_1(C_2)}{w_1(C_1)} \cdot \frac{w_2(C_1)}{w_2(C_2)}\]</div><h4 id="ReplicaPull-1"><a class="docs-heading-anchor" href="#ReplicaPull-1">ReplicaPull</a><a class="docs-heading-anchor-permalink" href="#ReplicaPull-1" title="Permalink"></a></h4><p><code>ReplicaPull()</code> is an experimental parallel update. Instead of synchronizing with another simulations it pulls a configuration asynchronously and uses that for a global update. This means that there is little waiting on other simulations, but configurations will be duplicated.</p><p>This update cycles through a pool of connected workers. This pool can be of any size. Each simulation must make itself available for pulling via <code>connect(target_workers)</code>. The <code>target_workers</code> should generally be the workers the simulation wants to receive configurations from. When a simulation reaches the end it will automatically <code>disconnect(target_workers)</code>.</p><h3 id="MPI-Updates-1"><a class="docs-heading-anchor" href="#MPI-Updates-1">MPI Updates</a><a class="docs-heading-anchor-permalink" href="#MPI-Updates-1" title="Permalink"></a></h3><h4 id="MPIReplicaExchange-1"><a class="docs-heading-anchor" href="#MPIReplicaExchange-1">MPIReplicaExchange</a><a class="docs-heading-anchor-permalink" href="#MPIReplicaExchange-1" title="Permalink"></a></h4><p>This is a MPI version of the replica exchange update. In this case <code>target</code> is an MPI rank. Much like the normal replica exchange update simulations need to be paired such that they request updates from each other.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../recorder/">« Configuration Recorder</a><a class="docs-footer-nextpage" href="../measurements/">Measurements »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 24 February 2022 15:53">Thursday 24 February 2022</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
