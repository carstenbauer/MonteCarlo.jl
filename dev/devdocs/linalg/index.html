<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear Algebra · MonteCarlo.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MonteCarlo.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">MonteCarlo.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">DQMC</span><ul><li><a class="tocitem" href="../../DQMC/Introduction/">Introduction</a></li><li><a class="tocitem" href="../../DQMC/model/">Model</a></li><li><a class="tocitem" href="../../DQMC/lattice/">Lattices</a></li><li><a class="tocitem" href="../../DQMC/fields/">Fields</a></li><li><a class="tocitem" href="../../DQMC/dqmc/">DQMC</a></li><li><a class="tocitem" href="../../DQMC/recorder/">Configuration Recorder</a></li><li><a class="tocitem" href="../../DQMC/scheduler/">Update Scheduler</a></li><li><a class="tocitem" href="../../DQMC/measurements/">Measurements</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/triangular_Hubbard/">Triangular Attractive Hubbard</a></li><li><a class="tocitem" href="../../examples/ALF1/">Crosscheck with ALF</a></li><li><a class="tocitem" href="../../examples/HofmannBergChowdhury/">Topological Flat Band Model</a></li></ul></li><li><span class="tocitem">Legacy</span><ul><li><a class="tocitem" href="../../legacy/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/manual/gettingstarted/">Getting started</a></li><li><a class="tocitem" href="../../legacy/manual/showcase/">Showcase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Physical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/models/ising/">Ising model</a></li><li><a class="tocitem" href="../../legacy/models/hubbardattractive/">Attractive Hubbard model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Monte Carlo flavors</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/flavors/mc/">MC</a></li><li><a class="tocitem" href="../../legacy/flavors/dqmc/">DQMC</a></li></ul></li><li><a class="tocitem" href="../../legacy/lattices/">Lattices</a></li><li><a class="tocitem" href="../../legacy/customize/">Customize</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/interfaces/MC/">MC</a></li><li><a class="tocitem" href="../../legacy/interfaces/DQMC/">DQMC</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">General exports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/methods/general/">General</a></li></ul></li></ul></li><li><span class="tocitem">DQMC Dev Docs</span><ul><li><a class="tocitem" href="../model_field/">Models and Fields</a></li><li><a class="tocitem" href="../dqmc_stacks/">DQMC Stacks</a></li><li><a class="tocitem" href="../measurements/">Measurements</a></li><li class="is-active"><a class="tocitem" href>Linear Algebra</a><ul class="internal"><li><a class="tocitem" href="#Special-Types-1"><span>Special Types</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">DQMC Dev Docs</a></li><li class="is-active"><a href>Linear Algebra</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear Algebra</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/carstenbauer/MonteCarlo.jl/blob/master/docs/src/devdocs/linalg.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-Algebra-1"><a class="docs-heading-anchor" href="#Linear-Algebra-1">Linear Algebra</a><a class="docs-heading-anchor-permalink" href="#Linear-Algebra-1" title="Permalink"></a></h1><p>MonteCarlo.jl makes heavy use of LoopVectorization to speed up linear algebra. The respective functions are mostly in &quot;flavors/DQMC/linalg&quot;, with a few more specific functions in places where they are needed. These functions are generally identified with a <code>v</code> prefix.</p><p>Generally the methods mirror the respective methods from LinearAlgebra - <code>vmul!</code> is a matrix multiplication like <code>mul!</code>, <code>rvmul!</code> and <code>lvmul!</code> match <code>rmul!</code> and <code>vmul!</code>. Usually MonteCarlo.jl only implements the methods that are actually used, so there won&#39;t be a method for every possible type combination. On the other hand there are also some new methods which are used with specialized matrix types, such as <code>vmul!(output, left, right, range)</code>.</p><p>To summarize the existing functions:</p><ul><li><code>vmul!(target, left, right)</code> calculates <code>target = left * right</code> in place</li><li><code>rvmul!(left, right::Diagonal)</code> calculates <code>left = left * right</code> in place</li><li><code>lvmul!(left::Diagonal, right)</code> calculates <code>right = left * right</code> in place</li><li><code>rvadd!(left, right)</code> calculates <code>left += right</code> in place</li><li><code>vsub!(output, left, ::UniformScaling)</code> calculates <code>output = left - I</code> in place</li><li><code>vmin!(v::Vector, w::Vector)</code> calculates <code>v .= min.(1, w)</code></li><li><code>vmininv!(v::Vector, w::Vector)</code> calculates <code>v .= 1 ./ min.(1, w)</code></li><li><code>vmax!(v::Vector, w::Vector)</code> calculates <code>v .= max.(1, w)</code></li><li><code>vmaxinv!(v::Vector, w::Vector)</code> calculates <code>v .= 1 ./ max.(1, w)</code></li><li><code>vinv!(v::Vector)</code> calculates <code>v .= 1 ./ v</code></li><li><code>vinv!(v::Vector, w::Vector)</code> calculates <code>v .= 1 ./ w</code></li><li><code>rdivp!(left, T, temp, pivot)</code> calculates <code>left * T^-1</code> where T is a pivoted upper triangular matrix as returned by <code>udt_AVX_pivot(U, D, T, pivot, temp, Val(false))</code></li></ul><p>And finally <code>udt_AVX_pivot!(U, D::Diagonal, T[, pivot, temp, apply_pivot::Val])</code> which performs a pivoted UDT decomposition, which is a QR decomposition with the diagonal values pulled out of the <code>R</code> matrix. The <code>T</code> matrix doubles as the input, <code>pivot</code> is an integer pivoting vector and <code>temp</code> is a temporary vector with eltype matching the input matrix . <code>apply_pivot</code> sets whether the output <code>T</code> matrix has pivoting applied, making it a true upper triangular matrix or not.</p><h2 id="Special-Types-1"><a class="docs-heading-anchor" href="#Special-Types-1">Special Types</a><a class="docs-heading-anchor-permalink" href="#Special-Types-1" title="Permalink"></a></h2><p>For optimization purposes we have a couple of custom matrix types.</p><p>The simplest is <code>CVec64</code> and <code>CMat64</code> which is just a shortened name for the <code>StructArray</code> of a complex vector or matrix. As noted in LoopVectorization <code>StructArray</code> is needed to handle complex matrices efficiently.</p><p>The next type is <code>BlockDiagonal</code> which is a matrix type consisting of square matrices on the diagonal. This type is used with, for example, two flavor problems which don&#39;t include terms mixing flavors. In that case the off-diagonal blocks are 0 matrices and don&#39;t need to be considered. Note that this type is only thoroughly tested for two equally sized blocks, and may need some extra work to extend to an arbitrary number of blocks.</p><p>The most complicated one is <code>CheckerboardDecomposed</code> which encodes a checkerboard decomposition of a hopping matrix. This decomposition uses the bond structure of the lattice and that the hopping matrix must be Hermitian to decompose it into a chain of sparse matrices, which can be multiplied onto a regular matrix more quickly. Note that this decomposition may increase or decrease the error caused by the Trotter decomposition.</p><p>Finally we have <code>DiagonallyRepeatingMatrix</code> which is a thin wrapper around a regular matrix type. It simply indicates that the contained matrix repeats along the diagonal. This is the case for models with multiple flavors, where the flavors mirror each other. This is only used in measurements.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../measurements/">« Measurements</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 28 April 2023 11:17">Friday 28 April 2023</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
