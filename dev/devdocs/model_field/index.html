<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Models and Fields · MonteCarlo.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MonteCarlo.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">MonteCarlo.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">DQMC</span><ul><li><a class="tocitem" href="../../DQMC/Introduction/">Introduction</a></li><li><a class="tocitem" href="../../DQMC/model/">Model</a></li><li><a class="tocitem" href="../../DQMC/lattice/">Lattices</a></li><li><a class="tocitem" href="../../DQMC/fields/">Fields</a></li><li><a class="tocitem" href="../../DQMC/dqmc/">DQMC</a></li><li><a class="tocitem" href="../../DQMC/recorder/">Configuration Recorder</a></li><li><a class="tocitem" href="../../DQMC/scheduler/">Update Scheduler</a></li><li><a class="tocitem" href="../../DQMC/measurements/">Measurements</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/triangular_Hubbard/">Triangular Attractive Hubbard</a></li><li><a class="tocitem" href="../../examples/ALF1/">Crosscheck with ALF</a></li><li><a class="tocitem" href="../../examples/HofmannBergChowdhury/">Topological Flat Band Model</a></li></ul></li><li><span class="tocitem">Legacy</span><ul><li><a class="tocitem" href="../../legacy/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/manual/gettingstarted/">Getting started</a></li><li><a class="tocitem" href="../../legacy/manual/showcase/">Showcase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Physical models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/models/ising/">Ising model</a></li><li><a class="tocitem" href="../../legacy/models/hubbardattractive/">Attractive Hubbard model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Monte Carlo flavors</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/flavors/mc/">MC</a></li><li><a class="tocitem" href="../../legacy/flavors/dqmc/">DQMC</a></li></ul></li><li><a class="tocitem" href="../../legacy/lattices/">Lattices</a></li><li><a class="tocitem" href="../../legacy/customize/">Customize</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Interfaces</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/interfaces/MC/">MC</a></li><li><a class="tocitem" href="../../legacy/interfaces/DQMC/">DQMC</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">General exports</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../legacy/methods/general/">General</a></li></ul></li></ul></li><li><span class="tocitem">DQMC Dev Docs</span><ul><li class="is-active"><a class="tocitem" href>Models and Fields</a><ul class="internal"><li><a class="tocitem" href="#The-Model-1"><span>The Model</span></a></li><li><a class="tocitem" href="#The-Field-1"><span>The Field</span></a></li></ul></li><li><a class="tocitem" href="../dqmc_stacks/">DQMC Stacks</a></li><li><a class="tocitem" href="../measurements/">Measurements</a></li><li><a class="tocitem" href="../linalg/">Linear Algebra</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">DQMC Dev Docs</a></li><li class="is-active"><a href>Models and Fields</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Models and Fields</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/carstenbauer/MonteCarlo.jl/blob/master/docs/src/devdocs/model_field.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Models-and-Fields-1"><a class="docs-heading-anchor" href="#Models-and-Fields-1">Models and Fields</a><a class="docs-heading-anchor-permalink" href="#Models-and-Fields-1" title="Permalink"></a></h1><p>The model and field of a simulation are two rather tightly connected components. The model represents the raw Hamiltonian of a problem, including an interactive term with four operators. The field controls how this interactive term is represented in a DQMC simulation. As such you may think of it as the implementation of the Hubbard Stratonovich transformation.</p><h2 id="The-Model-1"><a class="docs-heading-anchor" href="#The-Model-1">The Model</a><a class="docs-heading-anchor-permalink" href="#The-Model-1" title="Permalink"></a></h2><p>The model contains the lattice (which perhaps should be moved out) and whatever parameters are relevant to the model, i.e. whatever factors appear in the Hamiltonian.</p><h3 id="DQMC-Model-Interface-1"><a class="docs-heading-anchor" href="#DQMC-Model-Interface-1">DQMC - Model Interface</a><a class="docs-heading-anchor-permalink" href="#DQMC-Model-Interface-1" title="Permalink"></a></h3><p>The model interfaces with the rest of the simulation through a set of functions. These may generally be categorized as mandatory, optional and somewhere in between.</p><h4 id="Mandatory-Methods-1"><a class="docs-heading-anchor" href="#Mandatory-Methods-1">Mandatory Methods</a><a class="docs-heading-anchor-permalink" href="#Mandatory-Methods-1" title="Permalink"></a></h4><p>Mandatory methods are those every model has to provide for a DQMC simualtion to work.</p><ul><li><code>lattice(model)</code> needs to return a MonteCarlo compatible lattice.</li><li><code>total_flavors(model)</code> is the total number of fermion flavors present in the model. This will control the number of flavors considered in measurements.</li><li><code>unique_flavors(model)</code> is the number of unique fermion flavors present in the hopping matrix of the model. This should return 1 if the hopping matrix does not depend on the flavor index. </li><li><code>hopping_matrix(model)</code> needs to generate the hopping matrix, which includes all quadratic terms. (I.e. also the chemical potential.) The hopping matrix should only include as many flavors as necessary. If the hopping matrix contains two copies of the same matrix, one for spin up and one for spin down for example, then it should only return one of these. Expanding it to an appropriate size is handled internally.</li></ul><h4 id="(Semi-)-Optional-Methods-1"><a class="docs-heading-anchor" href="#(Semi-)-Optional-Methods-1">(Semi-) Optional Methods</a><a class="docs-heading-anchor-permalink" href="#(Semi-)-Optional-Methods-1" title="Permalink"></a></h4><p>These methods aren&#39;t strictly necessary to implement, but are typically good to have.</p><ul><li><code>_save(file::FileLike, entryname, model)</code> writes model information to the given file. It should also save the lattice via <code>_save(file, entryname, lattice)</code> and save a unique <code>tag</code>. If this is not implemented JLD2 will be asked to save the type as is, which makes it hard to load data when the model type is edited.</li><li><code>_load(data, ::Val{Symbol(tag)})</code> loads a model from <code>data</code>, which typically is a JLDFile. Note that saved tag is used to dispatch to the correct method.</li><li><code>intE_kernel(mc, model, idxs, G, ::Val{flv})</code> should be implemented to enable measurements of the energy from the interactive term as well as the total energy. </li><li><code>choose_field(model)</code> returns the default field type for a given model. If this is not implemented a field must be passed to <code>DQMC</code>.</li></ul><h4 id="Very-Optional-Methods-1"><a class="docs-heading-anchor" href="#Very-Optional-Methods-1">Very Optional Methods</a><a class="docs-heading-anchor-permalink" href="#Very-Optional-Methods-1" title="Permalink"></a></h4><p>These methods should work as is with their default implementation, or are unnecessary to the simulation. </p><ul><li><code>hopping_eltype(model) = eltype(hopping_matrix(model))</code> returns the element type of the hopping matrix.</li><li><code>hopping_matrix_type(field, model) = typeof(pad_to_nflavors(field, model, hopping_matrix(model)))</code> return the matrix type of the hopping matrix.</li><li><code>greens_eltype(field, model) = generalized_eltype(interaction_eltype(field), hopping_eltype(model))</code> returns the element type of the greens function. This must be compatible with element types of the hopping matrix and the interaction matrix.</li><li><code>greens_matrix_type(field, model) = Matrix{greens_eltype(field, model)}</code> returns the full type of the greens function. This must be compatible with both the type of the hopping matrix and the interaction matrix.</li><li><code>parameters(m::Model)</code> should collect the parameters from the model and lattice in a NamedTuple. This is a user facing function meant to collect relevant/summarized information on a simulation.</li></ul><p>Also note that you may need to update the measurement kernels. More information about that on the measurement page.</p><h2 id="The-Field-1"><a class="docs-heading-anchor" href="#The-Field-1">The Field</a><a class="docs-heading-anchor-permalink" href="#The-Field-1" title="Permalink"></a></h2><p>The field represents the interactive term post Hubbard-Stratonovich transform in DQMC. It generally consists of some constants necessary to calculate local updates propabilities, update the Greens function and calculate the interaction matrix, and the MonteCarlo configuration.</p><p>In terms of functionality we can again split the implemented function into a mandatory and optional category</p><h4 id="Mandatory-1"><a class="docs-heading-anchor" href="#Mandatory-1">Mandatory</a><a class="docs-heading-anchor-permalink" href="#Mandatory-1" title="Permalink"></a></h4><p>The mandatory function are necessary for a simualtion to run. Technically <code>propose_local!</code> and <code>accept_local!</code> are not absolutely mandatory, as one could run a simulation with only global updates. Doing so is however not a reasonable thing to do.</p><ul><li><code>unique_flavors(field)</code> is the minimum number of flavors the field requires. (Some Hubbard Stratonovich transformations may introduce an asymmetry between flavors which was not in the original Hamiltonian.)</li><li><code>interaction_matrix_exp!(field, result, time_slice, power)</code> writes the interaction matrix corresponding to the current field configuration to the given <code>result</code> matrix. <code>time_slice</code> defines the relevant imaginary time and <code>power = -1</code> is used to identify that the matrix needs to be inverted (otherwise <code>power = 1</code>).</li><li><code>propose_local!(mc, field, site, time_slice)</code> calculates the determinant ratio and the bosonic energy associated with an update to the field configuration at some <code>site</code> and <code>time_slice</code>. If the field configuration has multiple values it can update to, this function should randomly choose one of those values. The function may pass any number of extra arguments as a thrid return value, which will then be forwarded to <code>accept_local!()</code>.</li><li><code>accept_local!(mc, field, site, time_slice, args...)</code> updates the configuration and the greens matrix under the assumption that a previously proposed updates has been accepted. <code>site</code> and <code>time_slice</code> identify the element of the configuration that needs to be updated and <code>args...</code> may contain any number of arguments passed on from <code>propose_local!()</code>.</li></ul><p>The math and temporary variables used in the calculation of local updates are collected in the <code>FieldCache</code>. Between different combinations of types and flavors, you should find the optimized update formulas from <a href="https://doi.org/10.1017/CBO9780511902581">Quantum Monte Carlo Methods</a> here. </p><h4 id="Optional-1"><a class="docs-heading-anchor" href="#Optional-1">Optional</a><a class="docs-heading-anchor-permalink" href="#Optional-1" title="Permalink"></a></h4><p>The optional functions presented here should be implemented for the field to be fully compatible and performant. </p><ul><li><code>Base.rand(field)</code> and <code>Random.rand!(field)</code> are overloaded to provide a new field configuration. Mandatory for global updates.</li><li><code>compress(field)</code>, <code>compressed_conf_type(field)</code>, <code>decompres(field, compressed)</code> and <code>decompress!(field, compressed)</code> are implemented to fill out the compression interface for (configuration) recorders. Optional for file size optimization.</li><li><code>interaction_eltype(field)</code> and <code>interaction_matrix_type(field, model)</code> give type information on the interaction matrix to the simulation. Since the interaction matrix is set in place, this does not have efficient defaults and thus not implementing this will usually result in bad performance. (Defaults to <code>Float64</code> and <code>Matrix{Float64}</code>.)</li><li><code>energy_boson(field[, conf = field.conf])</code> computes the bosonic energy associated with a given configuration. This is mandatory for global updates.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../legacy/methods/general/">« General</a><a class="docs-footer-nextpage" href="../dqmc_stacks/">DQMC Stacks »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 28 April 2023 11:28">Friday 28 April 2023</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
